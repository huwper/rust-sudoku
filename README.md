https://garethrees.org/2007/06/10/zendoku-generation/#section-4